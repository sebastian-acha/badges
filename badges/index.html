<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Open Badges System - EduHive</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.5;
        }
        
        .loader {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .alert {
            padding: 12px 16px;
            border-radius: 6px;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .alert-success {
            background-color: #d1fae5;
            color: #065f46;
            border: 1px solid #6ee7b7;
        }
        
        .alert-error {
            background-color: #fee2e2;
            color: #991b1b;
            border: 1px solid #fca5a5;
        }
        
        .alert-info {
            background-color: #dbeafe;
            color: #1e40af;
            border: 1px solid #93c5fd;
        }
    </style>
</head>
<body>
    <div id="root">
        <div style="display: flex; justify-content: center; align-items: center; height: 100vh;">
            <div style="text-align: center;">
                <div class="loader"></div>
                <p style="margin-top: 16px; color: #6b7280;">Cargando aplicaci√≥n...</p>
            </div>
        </div>
    </div>

    <!-- React y ReactDOM desde CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel para JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@0.263.1/dist/umd/lucide.min.js"></script>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const { Award, Users, Send, CheckCircle, Key, AlertCircle } = lucide;

        // Configuraci√≥n de la API
        const API_BASE_URL = 'https://badges.eduhive.cl/api';
        
        const OpenBadgesSystem = () => {
          const [activeTab, setActiveTab] = useState('dashboard');
          const [badges, setBadges] = useState([]);
          const [recipients, setRecipients] = useState([]);
          const [apiKey, setApiKey] = useState('');
          const [showApiKey, setShowApiKey] = useState(false);
          const [loading, setLoading] = useState(false);
          const [alert, setAlert] = useState(null);

          useEffect(() => {
            loadBadges();
            loadRecipients();
            
            // Cargar API Key del localStorage del navegador
            const savedApiKey = localStorage.getItem('eduhive_api_key') || '';
            setApiKey(savedApiKey);
          }, []);

          const showAlert = (message, type = 'info') => {
            setAlert({ message, type });
            setTimeout(() => setAlert(null), 5000);
          };

          const saveApiKey = (key) => {
            setApiKey(key);
            localStorage.setItem('eduhive_api_key', key);
          };

          const loadBadges = async () => {
            try {
              setLoading(true);
              const response = await fetch(`${API_BASE_URL}/badges/index.php`);
              const data = await response.json();
              
              if (data.success && data.badges) {
                setBadges(data.badges);
              }
            } catch (error) {
              console.error('Error cargando badges:', error);
              showAlert('Error al cargar badges', 'error');
            } finally {
              setLoading(false);
            }
          };

          const loadRecipients = async () => {
            // Por ahora usaremos localStorage para las emisiones
            // Puedes crear un endpoint GET en el backend para listarlas
            const saved = localStorage.getItem('eduhive_recipients');
            if (saved) {
              setRecipients(JSON.parse(saved));
            }
          };

          const BadgeForm = () => {
            const [formData, setFormData] = useState({
              name: '',
              description: '',
              criteria: '',
              imageUrl: '',
              issuer: 'EduHive'
            });
            const [submitting, setSubmitting] = useState(false);

            const handleSubmit = async () => {
              if (!formData.name || !formData.description || !formData.criteria) {
                showAlert('Por favor completa todos los campos requeridos', 'error');
                return;
              }

              if (!apiKey) {
                showAlert('Por favor configura tu API Key en la pesta√±a API & Integraci√≥n', 'error');
                return;
              }

              try {
                setSubmitting(true);
                const response = await fetch(`${API_BASE_URL}/badges/create.php`, {
                  method: 'POST',
                  headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${apiKey}`
                  },
                  body: JSON.stringify(formData)
                });

                const data = await response.json();

                if (data.success) {
                  showAlert('Badge creado exitosamente', 'success');
                  setFormData({ name: '', description: '', criteria: '', imageUrl: '', issuer: 'EduHive' });
                  await loadBadges();
                } else {
                  showAlert(data.error || 'Error al crear badge', 'error');
                }
              } catch (error) {
                console.error('Error:', error);
                showAlert('Error de conexi√≥n al crear badge', 'error');
              } finally {
                setSubmitting(false);
              }
            };

            return (
              <div style={{
                backgroundColor: 'white',
                borderRadius: '8px',
                boxShadow: '0 1px 3px rgba(0,0,0,0.1)',
                padding: '24px',
                maxWidth: '600px',
                margin: '0 auto'
              }}>
                <h3 style={{
                  fontSize: '20px',
                  fontWeight: 'bold',
                  marginBottom: '16px',
                  color: '#1f2937'
                }}>Crear Nuevo Badge</h3>
                
                {alert && alert.type && (
                  <div className={`alert alert-${alert.type}`}>
                    <AlertCircle size={20} />
                    <span>{alert.message}</span>
                  </div>
                )}
                
                <div style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>
                  <div>
                    <label style={{
                      display: 'block',
                      fontSize: '14px',
                      fontWeight: '500',
                      color: '#374151',
                      marginBottom: '4px'
                    }}>Nombre del Badge *</label>
                    <input
                      type="text"
                      value={formData.name}
                      onChange={(e) => setFormData({...formData, name: e.target.value})}
                      style={{
                        width: '100%',
                        padding: '8px 12px',
                        border: '1px solid #d1d5db',
                        borderRadius: '6px',
                        fontSize: '14px'
                      }}
                      placeholder="Ej: Experto en Python"
                      disabled={submitting}
                    />
                  </div>
                  
                  <div>
                    <label style={{
                      display: 'block',
                      fontSize: '14px',
                      fontWeight: '500',
                      color: '#374151',
                      marginBottom: '4px'
                    }}>Descripci√≥n *</label>
                    <textarea
                      value={formData.description}
                      onChange={(e) => setFormData({...formData, description: e.target.value})}
                      style={{
                        width: '100%',
                        padding: '8px 12px',
                        border: '1px solid #d1d5db',
                        borderRadius: '6px',
                        fontSize: '14px',
                        minHeight: '80px',
                        fontFamily: 'inherit'
                      }}
                      placeholder="Describe qu√© representa este badge..."
                      disabled={submitting}
                    />
                  </div>

                  <div>
                    <label style={{
                      display: 'block',
                      fontSize: '14px',
                      fontWeight: '500',
                      color: '#374151',
                      marginBottom: '4px'
                    }}>Criterios de Obtenci√≥n *</label>
                    <textarea
                      value={formData.criteria}
                      onChange={(e) => setFormData({...formData, criteria: e.target.value})}
                      style={{
                        width: '100%',
                        padding: '8px 12px',
                        border: '1px solid #d1d5db',
                        borderRadius: '6px',
                        fontSize: '14px',
                        minHeight: '60px',
                        fontFamily: 'inherit'
                      }}
                      placeholder="Completar el curso con 80% de aprobaci√≥n..."
                      disabled={submitting}
                    />
                  </div>

                  <div>
                    <label style={{
                      display: 'block',
                      fontSize: '14px',
                      fontWeight: '500',
                      color: '#374151',
                      marginBottom: '4px'
                    }}>URL de Imagen (opcional)</label>
                    <input
                      type="url"
                      value={formData.imageUrl}
                      onChange={(e) => setFormData({...formData, imageUrl: e.target.value})}
                      style={{
                        width: '100%',
                        padding: '8px 12px',
                        border: '1px solid #d1d5db',
                        borderRadius: '6px',
                        fontSize: '14px'
                      }}
                      placeholder="https://ejemplo.com/badge.png"
                      disabled={submitting}
                    />
                  </div>

                  <button
                    onClick={handleSubmit}
                    disabled={submitting}
                    style={{
                      width: '100%',
                      backgroundColor: submitting ? '#9ca3af' : '#4f46e5',
                      color: 'white',
                      padding: '10px 16px',
                      borderRadius: '6px',
                      border: 'none',
                      fontWeight: '500',
                      cursor: submitting ? 'not-allowed' : 'pointer',
                      fontSize: '14px',
                      display: 'flex',
                      alignItems: 'center',
                      justifyContent: 'center',
                      gap: '8px'
                    }}
                  >
                    {submitting ? (
                      <>
                        <div className="loader"></div>
                        Creando...
                      </>
                    ) : (
                      'Crear Badge'
                    )}
                  </button>
                </div>
              </div>
            );
          };

          const IssueForm = () => {
            const [formData, setFormData] = useState({
              badgeId: '',
              recipientEmail: '',
              recipientName: '',
              evidence: ''
            });
            const [submitting, setSubmitting] = useState(false);

            const handleSubmit = async () => {
              if (!formData.badgeId || !formData.recipientEmail || !formData.recipientName) {
                showAlert('Por favor completa todos los campos requeridos', 'error');
                return;
              }

              if (!apiKey) {
                showAlert('Por favor configura tu API Key en la pesta√±a API & Integraci√≥n', 'error');
                return;
              }

              try {
                setSubmitting(true);
                const response = await fetch(`${API_BASE_URL}/badges/issue.php`, {
                  method: 'POST',
                  headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${apiKey}`
                  },
                  body: JSON.stringify({
                    badgeId: formData.badgeId,
                    recipient: {
                      name: formData.recipientName,
                      email: formData.recipientEmail
                    },
                    evidence: formData.evidence || undefined
                  })
                });

                const data = await response.json();

                if (data.success) {
                  showAlert(`Badge emitido exitosamente a ${formData.recipientName}`, 'success');
                  
                  // Guardar en localStorage
                  const newRecipients = [...recipients, data.assertion];
                  setRecipients(newRecipients);
                  localStorage.setItem('eduhive_recipients', JSON.stringify(newRecipients));
                  
                  setFormData({ badgeId: '', recipientEmail: '', recipientName: '', evidence: '' });
                } else {
                  showAlert(data.error || 'Error al emitir badge', 'error');
                }
              } catch (error) {
                console.error('Error:', error);
                showAlert('Error de conexi√≥n al emitir badge', 'error');
              } finally {
                setSubmitting(false);
              }
            };

            return (
              <div style={{
                backgroundColor: 'white',
                borderRadius: '8px',
                boxShadow: '0 1px 3px rgba(0,0,0,0.1)',
                padding: '24px',
                maxWidth: '600px',
                margin: '0 auto'
              }}>
                <h3 style={{
                  fontSize: '20px',
                  fontWeight: 'bold',
                  marginBottom: '16px',
                  color: '#1f2937'
                }}>Emitir Badge</h3>
                
                {alert && alert.type && (
                  <div className={`alert alert-${alert.type}`}>
                    <AlertCircle size={20} />
                    <span>{alert.message}</span>
                  </div>
                )}
                
                <div style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>
                  <div>
                    <label style={{
                      display: 'block',
                      fontSize: '14px',
                      fontWeight: '500',
                      color: '#374151',
                      marginBottom: '4px'
                    }}>Seleccionar Badge *</label>
                    <select
                      value={formData.badgeId}
                      onChange={(e) => setFormData({...formData, badgeId: e.target.value})}
                      style={{
                        width: '100%',
                        padding: '8px 12px',
                        border: '1px solid #d1d5db',
                        borderRadius: '6px',
                        fontSize: '14px'
                      }}
                      disabled={submitting}
                    >
                      <option value="">-- Selecciona un badge --</option>
                      {badges.map(badge => (
                        <option key={badge.id} value={badge.id}>{badge.name}</option>
                      ))}
                    </select>
                  </div>

                  <div>
                    <label style={{
                      display: 'block',
                      fontSize: '14px',
                      fontWeight: '500',
                      color: '#374151',
                      marginBottom: '4px'
                    }}>Nombre del Destinatario *</label>
                    <input
                      type="text"
                      value={formData.recipientName}
                      onChange={(e) => setFormData({...formData, recipientName: e.target.value})}
                      style={{
                        width: '100%',
                        padding: '8px 12px',
                        border: '1px solid #d1d5db',
                        borderRadius: '6px',
                        fontSize: '14px'
                      }}
                      placeholder="Juan P√©rez"
                      disabled={submitting}
                    />
                  </div>

                  <div>
                    <label style={{
                      display: 'block',
                      fontSize: '14px',
                      fontWeight: '500',
                      color: '#374151',
                      marginBottom: '4px'
                    }}>Email del Destinatario *</label>
                    <input
                      type="email"
                      value={formData.recipientEmail}
                      onChange={(e) => setFormData({...formData, recipientEmail: e.target.value})}
                      style={{
                        width: '100%',
                        padding: '8px 12px',
                        border: '1px solid #d1d5db',
                        borderRadius: '6px',
                        fontSize: '14px'
                      }}
                      placeholder="juan@ejemplo.com"
                      disabled={submitting}
                    />
                  </div>

                  <div>
                    <label style={{
                      display: 'block',
                      fontSize: '14px',
                      fontWeight: '500',
                      color: '#374151',
                      marginBottom: '4px'
                    }}>Evidencia (URL opcional)</label>
                    <input
                      type="url"
                      value={formData.evidence}
                      onChange={(e) => setFormData({...formData, evidence: e.target.value})}
                      style={{
                        width: '100%',
                        padding: '8px 12px',
                        border: '1px solid #d1d5db',
                        borderRadius: '6px',
                        fontSize: '14px'
                      }}
                      placeholder="https://ejemplo.com/certificado/123"
                      disabled={submitting}
                    />
                  </div>

                  <button
                    onClick={handleSubmit}
                    disabled={submitting}
                    style={{
                      width: '100%',
                      backgroundColor: submitting ? '#9ca3af' : '#16a34a',
                      color: 'white',
                      padding: '10px 16px',
                      borderRadius: '6px',
                      border: 'none',
                      fontWeight: '500',
                      cursor: submitting ? 'not-allowed' : 'pointer',
                      fontSize: '14px',
                      display: 'flex',
                      alignItems: 'center',
                      justifyContent: 'center',
                      gap: '8px'
                    }}
                  >
                    {submitting ? (
                      <>
                        <div className="loader"></div>
                        Emitiendo...
                      </>
                    ) : (
                      'Emitir Badge'
                    )}
                  </button>
                </div>
              </div>
            );
          };

          const ApiDocs = () => {
            const [localApiKey, setLocalApiKey] = useState(apiKey);

            const handleSaveApiKey = () => {
              saveApiKey(localApiKey);
              showAlert('API Key guardada exitosamente', 'success');
            };

            const exampleRequest = `POST https://badges.eduhive.cl/api/badges/issue.php
Content-Type: application/json
Authorization: Bearer ${apiKey || 'TU_API_KEY'}

{
  "badgeId": "1",
  "recipient": {
    "name": "Juan P√©rez",
    "email": "juan@ejemplo.com"
  },
  "evidence": "https://lms.ejemplo.com/curso/123/certificado"
}`;

            const exampleResponse = `{
  "success": true,
  "assertion": {
    "id": "urn:uuid:12345-67890",
    "type": "Assertion",
    "badge": {...},
    "recipient": {...},
    "issuedOn": "2025-11-13T10:30:00Z"
  }
}`;

            return (
              <div style={{
                backgroundColor: 'white',
                borderRadius: '8px',
                boxShadow: '0 1px 3px rgba(0,0,0,0.1)',
                padding: '24px',
                maxWidth: '900px',
                margin: '0 auto'
              }}>
                <h3 style={{
                  fontSize: '20px',
                  fontWeight: 'bold',
                  marginBottom: '16px',
                  color: '#1f2937'
                }}>Documentaci√≥n de API</h3>
                
                {alert && alert.type && (
                  <div className={`alert alert-${alert.type}`}>
                    <AlertCircle size={20} />
                    <span>{alert.message}</span>
                  </div>
                )}
                
                <div style={{ marginBottom: '24px' }}>
                  <label style={{
                    display: 'block',
                    fontSize: '14px',
                    fontWeight: '500',
                    color: '#374151',
                    marginBottom: '8px'
                  }}>Configurar API Key</label>
                  <p style={{
                    fontSize: '13px',
                    color: '#6b7280',
                    marginBottom: '8px'
                  }}>
                    Ingresa la API Key que obtuviste al ejecutar install.php en el servidor
                  </p>
                  <div style={{ display: 'flex', gap: '8px' }}>
                    <input
                      type={showApiKey ? "text" : "password"}
                      value={localApiKey}
                      onChange={(e) => setLocalApiKey(e.target.value)}
                      style={{
                        flex: 1,
                        padding: '8px 12px',
                        border: '1px solid #d1d5db',
                        borderRadius: '6px',
                        fontFamily: 'monospace',
                        fontSize: '13px'
                      }}
                      placeholder="obapi_xxxxxxxxxxxxxxxxxx"
                    />
                    <button
                      onClick={() => setShowApiKey(!showApiKey)}
                      style={{
                        padding: '8px 16px',
                        backgroundColor: '#f3f4f6',
                        borderRadius: '6px',
                        border: 'none',
                        cursor: 'pointer',
                        fontSize: '14px'
                      }}
                    >
                      {showApiKey ? 'üëÅÔ∏è Ocultar' : 'üëÅÔ∏è Mostrar'}
                    </button>
                    <button
                      onClick={handleSaveApiKey}
                      style={{
                        padding: '8px 16px',
                        backgroundColor: '#4f46e5',
                        color: 'white',
                        borderRadius: '6px',
                        border: 'none',
                        cursor: 'pointer',
                        fontSize: '14px',
                        fontWeight: '500'
                      }}
                    >
                      üíæ Guardar
                    </button>
                  </div>
                </div>

                <div style={{ display: 'flex', flexDirection: 'column', gap: '24px' }}>
                  <div>
                    <h4 style={{
                      fontWeight: '600',
                      color: '#1f2937',
                      marginBottom: '8px'
                    }}>Endpoints Disponibles</h4>
                    <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
                      <div style={{
                        borderLeft: '4px solid #16a34a',
                        paddingLeft: '16px',
                        paddingTop: '8px',
                        paddingBottom: '8px',
                        backgroundColor: '#f9fafb'
                      }}>
                        <div style={{
                          fontFamily: 'monospace',
                          fontSize: '13px',
                          color: '#15803d'
                        }}>POST /api/badges/issue.php</div>
                        <p style={{
                          fontSize: '13px',
                          color: '#4b5563',
                          marginTop: '4px'
                        }}>Emite un badge a un destinatario</p>
                      </div>
                      <div style={{
                        borderLeft: '4px solid #3b82f6',
                        paddingLeft: '16px',
                        paddingTop: '8px',
                        paddingBottom: '8px',
                        backgroundColor: '#f9fafb'
                      }}>
                        <div style={{
                          fontFamily: 'monospace',
                          fontSize: '13px',
                          color: '#1d4ed8'
                        }}>GET /api/badges/index.php</div>
                        <p style={{
                          fontSize: '13px',
                          color: '#4b5563',
                          marginTop: '4px'
                        }}>Lista todos los badges disponibles</p>
                      </div>
                      <div style={{
                        borderLeft: '4px solid #f59e0b',
                        paddingLeft: '16px',
                        paddingTop: '8px',
                        paddingBottom: '8px',
                        backgroundColor: '#f9fafb'
                      }}>
                        <div style={{
                          fontFamily: 'monospace',
                          fontSize: '13px',
                          color: '#b45309'
                        }}>POST /api/badges/create.php</div>
                        <p style={{
                          fontSize: '13px',
                          color: '#4b5563',
                          marginTop: '4px'
                        }}>Crea un nuevo badge</p>
                      </div>
                      <div style={{
                        borderLeft: '4px solid #a855f7',
                        paddingLeft: '16px',
                        paddingTop: '8px',
                        paddingBottom: '8px',
                        backgroundColor: '#f9fafb'
                      }}>
                        <div style={{
                          fontFamily: 'monospace',
                          fontSize: '13px',
                          color: '#7c3aed'
                        }}>GET /api/assertions/get.php?id=:id</div>
                        <p style={{
                          fontSize: '13px',
                          color: '#4b5563',
                          marginTop: '4px'
                        }}>Obtiene un badge emitido para verificaci√≥n</p>
                      </div>
                    </div>
                  </div>

                  <div>
                    <h4 style={{
                      fontWeight: '600',
                      color: '#1f2937',
                      marginBottom: '8px'
                    }}>Ejemplo de Petici√≥n</h4>
                    <pre style={{
                      backgroundColor: '#1f2937',
                      color: '#f3f4f6',
                      padding: '16px',
                      borderRadius: '6px',
                      overflowX: 'auto',
                      fontSize: '12px'
                    }}>
{exampleRequest}
                    </pre>
                  </div>

                  <div>
                    <h4 style={{
                      fontWeight: '600',
                      color: '#1f2937',
                      marginBottom: '8px'
                    }}>Ejemplo de Respuesta</h4>
                    <pre style={{
                      backgroundColor: '#1f2937',
                      color: '#f3f4f6',
                      padding: '16px',
                      borderRadius: '6px',
                      overflowX: 'auto',
                      fontSize: '12px'
                    }}>
{exampleResponse}
                    </pre>
                  </div>

                  <div style={{
                    backgroundColor: '#dbeafe',
                    border: '1px solid #93c5fd',
                    borderRadius: '6px',
                    padding: '16px'
                  }}>
                    <h4 style={{
                      fontWeight: '600',
                      color: '#1e40af',
                      marginBottom: '8px'
                    }}>üîó Integraci√≥n con LMS</h4>
                    <p style={{
                      fontSize: '13px',
                      color: '#1e3a8a',
                      marginBottom: '8px'
                    }}>
                      Para integrar con tu LMS (Moodle, Canvas, etc.), utiliza webhooks o plugins que permitan hacer llamadas HTTP POST al completar un curso.
                    </p>
                    <ul style={{
                      fontSize: '13px',
                      color: '#92400e',
                      paddingLeft: '20px',
                      display: 'flex',
                      flexDirection: 'column',
                      gap: '4px'
                    }}>
                      <li>Guarda tu API Key de forma segura</li>
                      <li>No compartas tu API Key p√∫blicamente</li>
                      <li>Si crees que tu clave fue comprometida, genera una nueva en la base de datos</li>
                      <li>Verifica que tu backend tenga SSL (HTTPS) configurado</li>
                    </ul>
                  </div>
                </div>
              </div>
            );
          };

          const Dashboard = () => (
            <div style={{ display: 'flex', flexDirection: 'column', gap: '24px' }}>
              <div style={{
                display: 'grid',
                gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))',
                gap: '16px'
              }}>
                <div style={{
                  background: 'linear-gradient(135deg, #4f46e5 0%, #6366f1 100%)',
                  borderRadius: '8px',
                  boxShadow: '0 4px 6px rgba(0,0,0,0.1)',
                  padding: '24px',
                  color: 'white'
                }}>
                  <div style={{
                    display: 'flex',
                    justifyContent: 'space-between',
                    alignItems: 'center'
                  }}>
                    <div>
                      <p style={{
                        color: '#c7d2fe',
                        fontSize: '13px',
                        marginBottom: '4px'
                      }}>Total Badges</p>
                      <p style={{
                        fontSize: '32px',
                        fontWeight: 'bold'
                      }}>{badges.length}</p>
                    </div>
                    <Award size={48} style={{ opacity: 0.8 }} />
                  </div>
                </div>

                <div style={{
                  background: 'linear-gradient(135deg, #16a34a 0%, #22c55e 100%)',
                  borderRadius: '8px',
                  boxShadow: '0 4px 6px rgba(0,0,0,0.1)',
                  padding: '24px',
                  color: 'white'
                }}>
                  <div style={{
                    display: 'flex',
                    justifyContent: 'space-between',
                    alignItems: 'center'
                  }}>
                    <div>
                      <p style={{
                        color: '#bbf7d0',
                        fontSize: '13px',
                        marginBottom: '4px'
                      }}>Badges Emitidos</p>
                      <p style={{
                        fontSize: '32px',
                        fontWeight: 'bold'
                      }}>{recipients.length}</p>
                    </div>
                    <Send size={48} style={{ opacity: 0.8 }} />
                  </div>
                </div>

                <div style={{
                  background: 'linear-gradient(135deg, #9333ea 0%, #a855f7 100%)',
                  borderRadius: '8px',
                  boxShadow: '0 4px 6px rgba(0,0,0,0.1)',
                  padding: '24px',
                  color: 'white'
                }}>
                  <div style={{
                    display: 'flex',
                    justifyContent: 'space-between',
                    alignItems: 'center'
                  }}>
                    <div>
                      <p style={{
                        color: '#e9d5ff',
                        fontSize: '13px',
                        marginBottom: '4px'
                      }}>Destinatarios</p>
                      <p style={{
                        fontSize: '32px',
                        fontWeight: 'bold'
                      }}>{new Set(recipients.map(r => r.recipientEmail)).size}</p>
                    </div>
                    <Users size={48} style={{ opacity: 0.8 }} />
                  </div>
                </div>
              </div>

              <div style={{
                display: 'grid',
                gridTemplateColumns: 'repeat(auto-fit, minmax(350px, 1fr))',
                gap: '24px'
              }}>
                <div style={{
                  backgroundColor: 'white',
                  borderRadius: '8px',
                  boxShadow: '0 1px 3px rgba(0,0,0,0.1)',
                  padding: '24px'
                }}>
                  <h3 style={{
                    fontSize: '18px',
                    fontWeight: 'bold',
                    marginBottom: '16px',
                    color: '#1f2937'
                  }}>Badges Disponibles</h3>
                  {loading ? (
                    <div style={{ textAlign: 'center', padding: '32px 0' }}>
                      <div className="loader" style={{ margin: '0 auto' }}></div>
                      <p style={{ marginTop: '8px', color: '#6b7280' }}>Cargando...</p>
                    </div>
                  ) : badges.length === 0 ? (
                    <div style={{ textAlign: 'center', padding: '32px 0' }}>
                      <p style={{ color: '#6b7280', marginBottom: '8px' }}>No hay badges creados a√∫n</p>
                      <button
                        onClick={() => setActiveTab('create')}
                        style={{
                          padding: '8px 16px',
                          backgroundColor: '#4f46e5',
                          color: 'white',
                          border: 'none',
                          borderRadius: '6px',
                          cursor: 'pointer',
                          fontSize: '14px'
                        }}
                      >
                        Crear el primero
                      </button>
                    </div>
                  ) : (
                    <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
                      {badges.slice(0, 5).map(badge => (
                        <div key={badge.id} style={{
                          display: 'flex',
                          alignItems: 'center',
                          gap: '12px',
                          padding: '12px',
                          border: '1px solid #e5e7eb',
                          borderRadius: '6px'
                        }}>
                          <img src={badge.image} alt={badge.name} style={{
                            width: '48px',
                            height: '48px',
                            borderRadius: '4px',
                            objectFit: 'cover'
                          }} />
                          <div style={{ flex: 1 }}>
                          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                            <p style={{
                              fontWeight: '500',
                              color: '#1f2937',
                              marginBottom: '2px'
                            }}>{badge.name}</p>
                            <span style={{
                              fontSize: '11px',
                              backgroundColor: '#f3f4f6',
                              padding: '2px 6px',
                              borderRadius: '4px',
                              color: '#6b7280',
                              fontFamily: 'monospace'
                            }}>ID: {badge.id}</span>
                          </div>
                          <p style={{
                            fontSize: '13px',
                            color: '#6b7280'
                          }}>{badge.description.substring(0, 50)}{badge.description.length > 50 ? '...' : ''}</p>
                          </div>
                        </div>
                      ))}
                      {badges.length > 5 && (
                        <p style={{
                          textAlign: 'center',
                          color: '#6b7280',
                          fontSize: '13px',
                          marginTop: '8px'
                        }}>Y {badges.length - 5} m√°s...</p>
                      )}
                    </div>
                  )}
                </div>

                <div style={{
                  backgroundColor: 'white',
                  borderRadius: '8px',
                  boxShadow: '0 1px 3px rgba(0,0,0,0.1)',
                  padding: '24px'
                }}>
                  <h3 style={{
                    fontSize: '18px',
                    fontWeight: 'bold',
                    marginBottom: '16px',
                    color: '#1f2937'
                  }}>Emisiones Recientes</h3>
                  {recipients.length === 0 ? (
                    <div style={{ textAlign: 'center', padding: '32px 0' }}>
                      <p style={{ color: '#6b7280', marginBottom: '8px' }}>No hay badges emitidos a√∫n</p>
                      <button
                        onClick={() => setActiveTab('issue')}
                        style={{
                          padding: '8px 16px',
                          backgroundColor: '#16a34a',
                          color: 'white',
                          border: 'none',
                          borderRadius: '6px',
                          cursor: 'pointer',
                          fontSize: '14px'
                        }}
                      >
                        Emitir el primero
                      </button>
                    </div>
                  ) : (
                    <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
                      {recipients.slice(-5).reverse().map(assertion => (
                        <div key={assertion.id} style={{
                          display: 'flex',
                          alignItems: 'center',
                          gap: '12px',
                          padding: '12px',
                          border: '1px solid #e5e7eb',
                          borderRadius: '6px'
                        }}>
                          <CheckCircle size={32} style={{ color: '#16a34a', flexShrink: 0 }} />
                          <div style={{ flex: 1, minWidth: 0 }}>
                            <p style={{
                              fontWeight: '500',
                              color: '#1f2937',
                              marginBottom: '2px',
                              overflow: 'hidden',
                              textOverflow: 'ellipsis',
                              whiteSpace: 'nowrap'
                            }}>{assertion.recipientName}</p>
                            <p style={{
                              fontSize: '13px',
                              color: '#6b7280',
                              marginBottom: '2px',
                              overflow: 'hidden',
                              textOverflow: 'ellipsis',
                              whiteSpace: 'nowrap'
                            }}>{assertion.badge.name}</p>
                            <p style={{
                              fontSize: '12px',
                              color: '#9ca3af'
                            }}>{new Date(assertion.issuedOn).toLocaleDateString('es-CL')}</p>
                          </div>
                        </div>
                      ))}
                      {recipients.length > 5 && (
                        <p style={{
                          textAlign: 'center',
                          color: '#6b7280',
                          fontSize: '13px',
                          marginTop: '8px'
                        }}>Y {recipients.length - 5} m√°s...</p>
                      )}
                    </div>
                  )}
                </div>
              </div>
            </div>
          );

          return (
            <div style={{
              minHeight: '100vh',
              background: 'linear-gradient(135deg, #f9fafb 0%, #f3f4f6 100%)'
            }}>
              <div style={{
                backgroundColor: 'white',
                boxShadow: '0 1px 2px rgba(0,0,0,0.05)',
                borderBottom: '1px solid #e5e7eb'
              }}>
                <div style={{
                  maxWidth: '1280px',
                  margin: '0 auto',
                  padding: '16px 24px'
                }}>
                  <div style={{
                    display: 'flex',
                    alignItems: 'center',
                    gap: '12px'
                  }}>
                    <div style={{
                      backgroundColor: '#4f46e5',
                      padding: '8px',
                      borderRadius: '8px'
                    }}>
                      <Award size={32} color="white" />
                    </div>
                    <div>
                      <h1 style={{
                        fontSize: '24px',
                        fontWeight: 'bold',
                        color: '#1f2937',
                        margin: 0
                      }}>Open Badges System - EduHive</h1>
                      <p style={{
                        fontSize: '13px',
                        color: '#6b7280',
                        margin: 0
                      }}>Sistema de emisi√≥n y gesti√≥n de badges digitales</p>
                    </div>
                  </div>
                </div>
              </div>

              <div style={{
                maxWidth: '1280px',
                margin: '0 auto',
                padding: '24px'
              }}>
                {alert && (
                  <div className={`alert alert-${alert.type}`} style={{ marginBottom: '24px' }}>
                    <AlertCircle size={20} />
                    <span>{alert.message}</span>
                  </div>
                )}

                <div style={{
                  display: 'flex',
                  gap: '8px',
                  marginBottom: '24px',
                  overflowX: 'auto',
                  paddingBottom: '8px'
                }}>
                  {[
                    { id: 'dashboard', label: 'Dashboard', icon: Award },
                    { id: 'create', label: 'Crear Badge', icon: Award },
                    { id: 'issue', label: 'Emitir Badge', icon: Send },
                    { id: 'api', label: 'API & Integraci√≥n', icon: Key }
                  ].map(tab => {
                    const Icon = tab.icon;
                    return (
                      <button
                        key={tab.id}
                        onClick={() => setActiveTab(tab.id)}
                        style={{
                          display: 'flex',
                          alignItems: 'center',
                          gap: '8px',
                          padding: '10px 16px',
                          borderRadius: '6px',
                          border: 'none',
                          fontWeight: '500',
                          cursor: 'pointer',
                          fontSize: '14px',
                          whiteSpace: 'nowrap',
                          backgroundColor: activeTab === tab.id ? '#4f46e5' : 'white',
                          color: activeTab === tab.id ? 'white' : '#4b5563',
                          transition: 'all 0.2s'
                        }}
                        onMouseOver={(e) => {
                          if (activeTab !== tab.id) {
                            e.currentTarget.style.backgroundColor = '#f3f4f6';
                          }
                        }}
                        onMouseOut={(e) => {
                          if (activeTab !== tab.id) {
                            e.currentTarget.style.backgroundColor = 'white';
                          }
                        }}
                      >
                        <Icon size={16} />
                        {tab.label}
                      </button>
                    );
                  })}
                </div>

                {activeTab === 'dashboard' && <Dashboard />}
                {activeTab === 'create' && <BadgeForm />}
                {activeTab === 'issue' && <IssueForm />}
                {activeTab === 'api' && <ApiDocs />}
              </div>
            </div>
          );
        };

        // Renderizar la aplicaci√≥n
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<OpenBadgesSystem />);
    </script>
</body>
</html>',
                      color: '#1e3a8a',
                      paddingLeft: '20px',
                      display: 'flex',
                      flexDirection: 'column',
                      gap: '4px'
                    }}>
                      <li>Endpoint: <code style={{
                        backgroundColor: '#bfdbfe',
                        padding: '2px 4px',
                        borderRadius: '3px',
                        fontFamily: 'monospace'
                      }}>https://badges.eduhive.cl/api/badges/issue.php</code></li>
                      <li>Header: <code style={{
                        backgroundColor: '#bfdbfe',
                        padding: '2px 4px',
                        borderRadius: '3px',
                        fontFamily: 'monospace'
                      }}>Authorization: Bearer TU_API_KEY</code></li>
                      <li>M√©todo: POST</li>
                      <li>Content-Type: application/json</li>
                    </ul>
                  </div>
                  
                  <div style={{
                    backgroundColor: '#fef3c7',
                    border: '1px solid #fcd34d',
                    borderRadius: '6px',
                    padding: '16px'
                  }}>
                    <h4 style={{
                      fontWeight: '600',
                      color: '#92400e',
                      marginBottom: '8px'
                    }}>‚ö†Ô∏è Importante</h4>
                    <ul style={{
                      fontSize: '13px